{"ast":null,"code":"import * as tslib_1 from \"tslib\";\n\nfunction ItoI(a) {\n  return a;\n}\n\nfunction innerCreateMedium(defaults, middleware) {\n  if (middleware === void 0) {\n    middleware = ItoI;\n  }\n\n  var buffer = [];\n  var assigned = false;\n  var medium = {\n    read: function () {\n      if (assigned) {\n        throw new Error('Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.');\n      }\n\n      if (buffer.length) {\n        return buffer[buffer.length - 1];\n      }\n\n      return defaults;\n    },\n    useMedium: function (data) {\n      var item = middleware(data, assigned);\n      buffer.push(item);\n      return function () {\n        buffer = buffer.filter(function (x) {\n          return x !== item;\n        });\n      };\n    },\n    assignSyncMedium: function (cb) {\n      assigned = true;\n\n      while (buffer.length) {\n        var cbs = buffer;\n        buffer = [];\n        cbs.forEach(cb);\n      }\n\n      buffer = {\n        push: function (x) {\n          return cb(x);\n        },\n        filter: function () {\n          return buffer;\n        }\n      };\n    },\n    assignMedium: function (cb) {\n      assigned = true;\n      var pendingQueue = [];\n\n      if (buffer.length) {\n        var cbs = buffer;\n        buffer = [];\n        cbs.forEach(cb);\n        pendingQueue = buffer;\n      }\n\n      var executeQueue = function () {\n        var cbs = pendingQueue;\n        pendingQueue = [];\n        cbs.forEach(cb);\n      };\n\n      var cycle = function () {\n        return Promise.resolve().then(executeQueue);\n      };\n\n      cycle();\n      buffer = {\n        push: function (x) {\n          pendingQueue.push(x);\n          cycle();\n        },\n        filter: function (filter) {\n          pendingQueue = pendingQueue.filter(filter);\n          return buffer;\n        }\n      };\n    }\n  };\n  return medium;\n}\n\nexport function createMedium(defaults, middleware) {\n  if (middleware === void 0) {\n    middleware = ItoI;\n  }\n\n  return innerCreateMedium(defaults, middleware);\n}\nexport function createSidecarMedium(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var medium = innerCreateMedium(null);\n  medium.options = tslib_1.__assign({\n    async: true,\n    ssr: false\n  }, options);\n  return medium;\n}","map":{"version":3,"names":["tslib_1","ItoI","a","innerCreateMedium","defaults","middleware","buffer","assigned","medium","read","Error","length","useMedium","data","item","push","filter","x","assignSyncMedium","cb","cbs","forEach","assignMedium","pendingQueue","executeQueue","cycle","Promise","resolve","then","createMedium","createSidecarMedium","options","__assign","async","ssr"],"sources":["/Users/santiagotonoli/Desktop/Portfolio/node_modules/use-sidecar/dist/es2015/medium.js"],"sourcesContent":["import * as tslib_1 from \"tslib\";\nfunction ItoI(a) {\n    return a;\n}\nfunction innerCreateMedium(defaults, middleware) {\n    if (middleware === void 0) { middleware = ItoI; }\n    var buffer = [];\n    var assigned = false;\n    var medium = {\n        read: function () {\n            if (assigned) {\n                throw new Error('Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.');\n            }\n            if (buffer.length) {\n                return buffer[buffer.length - 1];\n            }\n            return defaults;\n        },\n        useMedium: function (data) {\n            var item = middleware(data, assigned);\n            buffer.push(item);\n            return function () {\n                buffer = buffer.filter(function (x) { return x !== item; });\n            };\n        },\n        assignSyncMedium: function (cb) {\n            assigned = true;\n            while (buffer.length) {\n                var cbs = buffer;\n                buffer = [];\n                cbs.forEach(cb);\n            }\n            buffer = {\n                push: function (x) { return cb(x); },\n                filter: function () { return buffer; },\n            };\n        },\n        assignMedium: function (cb) {\n            assigned = true;\n            var pendingQueue = [];\n            if (buffer.length) {\n                var cbs = buffer;\n                buffer = [];\n                cbs.forEach(cb);\n                pendingQueue = buffer;\n            }\n            var executeQueue = function () {\n                var cbs = pendingQueue;\n                pendingQueue = [];\n                cbs.forEach(cb);\n            };\n            var cycle = function () { return Promise.resolve().then(executeQueue); };\n            cycle();\n            buffer = {\n                push: function (x) {\n                    pendingQueue.push(x);\n                    cycle();\n                },\n                filter: function (filter) {\n                    pendingQueue = pendingQueue.filter(filter);\n                    return buffer;\n                },\n            };\n        },\n    };\n    return medium;\n}\nexport function createMedium(defaults, middleware) {\n    if (middleware === void 0) { middleware = ItoI; }\n    return innerCreateMedium(defaults, middleware);\n}\nexport function createSidecarMedium(options) {\n    if (options === void 0) { options = {}; }\n    var medium = innerCreateMedium(null);\n    medium.options = tslib_1.__assign({ async: true, ssr: false }, options);\n    return medium;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}